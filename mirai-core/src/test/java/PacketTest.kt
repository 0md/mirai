import net.mamoe.mirai.network.packet.server.login.ServerLoginResponseSuccessPacket
import net.mamoe.mirai.util.hexToBytes
import java.io.DataInputStream

@ExperimentalUnsignedTypes
fun main(){
    /*
    val data = "00 37 13 08 25 31 01 EB 10 08 30 69 50 1C 84 A9 C2 16 D7 52 B9 1C 79 CA 5A CF FD BC EB 10 08 30 69 50 1C 84 A9 C2 16 D7 52 B9 1C 79 CA 5A CF FD BC AE D8 A6 BB DC 21 6E 79 26 E1 A2 23 11 AA B0 9A AE D8 A6 BB DC 21 6E 79 26 E1 A2 23 11 AA B0 9A 76 E4 B8 DD 03 00 00 00 01 2E 01 00 00 68 52 00 00 00 00 A4 F1 91 88 C9 82 14 99 0C 9E 56 55 91 23 C8 3D C3 47 F0 25 A1 8E 74 EF 1E 0B 32 5B 20 8A FA 3B 0B 52 8F 86 E6 04 F1 D6 F8 63 75 60 8C 0C 7D 06 D1 E0 22 F8 49 EF AF 61 EE 7E 69 72 EB 10 08 30 69 50 1C 84 A9 C2 16 D7 52 B9 1C 79 CA 5A CF FD BC AE D8 A6 BB DC 21 6E 79 26 E1 A2 23 11 AA B0 9A 49 39 72 ED 61 12 B6 88 4D A2 56 23 E9 92 11 92 27 4A 70 00 C9 01 7B 03";
    val s = DataInputStream(data.hexToBytes().inputStream())
    val packet = ServerTouchResponsePacket(ServerTouchResponsePacket.Type.TYPE_08_25_31_01, s)
    packet.decode()
    System.out.println(packet.token.toUByteArray().toHexString(" "))
    System.out.println(packet.loginTime.toHexString(" "))
    System.out.println(packet.loginIP)
    */

   // val packet = ClientPasswordSubmissionPacket(1994701021,"xiaoqqq",)

    val data = "00 01 09 00 70 00 01 23 7B FE 83 D1 37 64 46 84 9D E9 9C E7 BB 8E 44 00 38 9B A4 3B C2 BB 49 4C DA B0 A5 5C C8 27 29 74 EF CB 38 59 4E 03 C8 15 C6 F9 BF 3F 88 22 7E 22 5B 48 02 71 59 1A 2C C8 42 BA 81 76 66 0C 46 91 89 6C B2 17 BF 2A 00 F8 8B 00 20 7C 28 07 3D AA 24 EF B4 49 9D 85 7F 4C F5 41 56 F4 1F AD 53 81 9F C1 03 F3 03 65 DD 0C 04 CC 68 00 00 01 03 00 14 00 01 00 10 60 C9 5D A7 45 70 04 7F 21 7D 84 50 5C 66 A5 C6 01 07 01 D3 00 01 00 16 00 00 00 01 00 00 00 64 00 00 0D FD 00 09 3A 80 00 00 00 3C 00 02 68 6E 6A 38 6A 50 36 71 43 72 60 2A 5A 29 72 3D 00 88 00 04 5D 59 19 96 B7 5F F8 D4 00 00 00 00 00 78 B9 8D 0C 93 E9 54 A1 D4 5A E8 44 84 F9 A6 47 58 BB 32 8F 97 A1 40 70 B7 49 30 60 04 15 D4 4F D1 E0 52 53 20 8F 16 4E 02 2E 36 0C E5 4A 64 41 80 84 C6 15 74 16 37 BC 59 7B 19 EA ED A2 20 61 79 03 24 75 12 80 D5 87 47 09 52 53 5C 99 DA 89 A9 AB B4 35 43 B8 86 92 7F D9 53 04 10 9E 9E CC 4F FE 7F B3 67 CF 39 C9 9B 74 B9 16 CC 4E 71 27 E2 51 FB 5E 30 6A A6 34 BB 4A 74 5A 47 48 28 24 69 79 6D 2D 63 35 32 40 35 00 78 00 01 5D 59 19 96 00 70 0F 3E 2C E5 BC 62 C6 C3 0A 06 01 DB 81 C5 73 BE B0 6A D0 2F 36 E5 F4 0E E2 EC 50 03 0E 7B 30 9A 38 F7 82 87 F7 65 AE E9 FE 98 82 49 A5 E6 9F E7 46 71 C3 9F 69 BD 13 08 65 3F 78 3F 57 7B 14 B3 BE 74 87 1B F6 C3 FC E9 A2 78 4E FE E2 7C 0A DD DD 38 E9 52 25 79 8A 8A CF 25 B0 E2 62 65 B8 A5 95 ED AC 48 B7 D6 2E AA A8 6A C3 FF 56 E3 7F 0F 00 83 01 3C 78 52 35 69 24 68 3F 76 55 25 37 60 43 40 64 00 70 00 01 5D 59 19 96 00 68 BA BF 74 0D 6D E6 81 FF 63 B5 EB A3 44 A8 3F 9E 25 36 D0 B3 29 14 24 5A 34 17 32 88 4D F6 96 4D 8A 4F 6B 00 45 CF AD 0A 17 74 C9 75 45 98 1F 20 E0 CD 89 32 21 7B 3C 60 9E AE 2B EE 23 2C 87 F2 C8 30 9F CD 93 1E 07 A5 5C 67 F3 71 01 9D 86 BB B5 0F 3E ED AB 39 F4 09 C4 8C 0A DD 65 04 A9 9E 3E 97 08 BE 40 4C 66 56 70 5F 45 47 6A 5E 4D 36 38 29 34 53 3D 3B 2C 52 01 08 00 29 00 01 00 25 00 1D 02 5B 14 28 E0 B9 91 E2 80 A2 CC 80 CF 89 E2 80 A2 CC 81 E0 B9 91 29 02 13 80 02 00 05 00 04 00 00 00 01 01 15 00 10 1C 57 7F 1B BF 9C 97 09 79 30 5C 17 43 B9 A2 FC"
    val s = DataInputStream(data.hexToBytes().inputStream())
    val packet = ServerLoginResponseSuccessPacket(s,(data.length+1)/3)

    System.out.println(packet._0828_rec_decr_key)
}